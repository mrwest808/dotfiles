#!/bin/bash
set -e

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

# Install Oh My Zsh
if [ ! -d ~/.oh-my-zsh ]; then
  echo "+ Installing Oh My Zsh"
  sh -c "$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)"
else
  echo "+ Oh My Zsh already installed"
fi

# Symlink .zshrc
if [ -L ~/.zshrc ]; then
  echo "+ .zshrc is already symlinked"
else
  if [ -f ~/.zshrc ]; then
    # Rename existing .zshrc before symlinking
    echo "+ Renaming existing .zshrc -> .zshrc.pre-dotfiles"
    mv ~/.zshrc ~/.zshrc.pre-dotfiles
  fi

  echo "+ Symlink .zshrc"
  ln -sf $DIR/zshrc ~/.zshrc
fi

# Install Pure prompt
if type npm >/dev/null 2>&1; then
  if ! npm list --depth 1 --global pure-prompt > /dev/null 2>&1; then
    echo "+ Installing Pure prompt"
    npm install --global pure-prompt
  else
    echo "+ Pure prompt already installed"
  fi
else
  echo "! Install pure-prompt manually via npm"
fi
